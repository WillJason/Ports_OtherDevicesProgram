C51 COMPILER V9.01   MYLIB                                                                 07/20/2013 21:44:04 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MYLIB
OBJECT MODULE PLACED IN .\output\mylib.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE src\mylib.c BROWSE DEBUG OBJECTEXTEND PRINT(.\output\mylib.lst) OBJECT(.\ou
                    -tput\mylib.obj)

line level    source

   1          #include "config.h"
   2          
   3          /*********************************************************************************************************
             -*********
   4                                    常 用 函 数 库 
   5          
   6           - 延时函数：
   7          **********************************************************************************************************
             -********/
   8          cc Status0 , Status1 ;
   9          const INT8U asc_number[] = "0123456789";   ///<0~9的ASCII码表
  10          
  11          INT8U bcd_number[5];
  12          /*****************************************************************************************************
  13           - 功能描述：10us的延时函数
  14           - 隶属模块：常用函数库(内部)
  15           - 参数说明：无
  16           - 返回参数：无
  17           - 注： 在这里的运行环境是51,晶振为12MHZ                
  18          *****************************************************************************************************/
  19          void Delay_Us(INT32U z)
  20          {
  21   1              while(z--);
  22   1      }
  23          
  24          /***********************毫秒级别延时************************/
  25          
  26          void Delay_Ms(INT32U z)
  27          {
  28   1              INT32U x=0 , y=0;
  29   1              for(x=110 ; x>0 ;x--)
  30   1              for(y=z; y>0;y-- );
  31   1      }
  32          
  33          /*****************************************************************************************************
  34           - 函数说明：获取一个一位十进制的数的个位
  35           - 隶属模块：内部
  36           - 参数说明：i:输入的一个一位十进制的数
  37           - 返回说明：
  38           - 注      ：
  39          *****************************************************************************************************/
  40          void itoa1(INT8U i)
  41          {
  42   1              bcd_number[0] = asc_number[i % 10];
  43   1              bcd_number[1] = 0;
  44   1      }
  45          
  46          /*****************************************************************************************************
  47           - 函数说明：获取一个2位十进制的数的各个位
  48           - 隶属模块：内部
  49           - 参数说明：i:输入的一个2位十进制的数
  50           - 返回说明：
  51           - 注      ：
  52          *****************************************************************************************************/
C51 COMPILER V9.01   MYLIB                                                                 07/20/2013 21:44:04 PAGE 2   

  53          void itoa2(INT8U i)
  54          {
  55   1              bcd_number[0] = asc_number[(i % 100) / 10];
  56   1              bcd_number[1] = asc_number[(i % 10)];
  57   1              bcd_number[2] = 0;
  58   1      }
  59          
  60          /*****************************************************************************************************
  61           - 函数说明：获取一个3位十进制数的各个位
  62           - 隶属模块：内部
  63           - 参数说明：i:输入的一个3位十进制数
  64           - 返回说明：
  65           - 注      ：
  66          *****************************************************************************************************/
  67          void itoa3(INT16U i)
  68          {
  69   1              bcd_number[0] = asc_number[(i % 1000) / 100];
  70   1              bcd_number[1] = asc_number[(i % 100) / 10];
  71   1              bcd_number[2] = asc_number[i % 10];
  72   1              bcd_number[3] = 0;
  73   1      }
  74          
  75          /*****************************************************************************************************
  76           - 函数说明：获取一个4位十进制的数的各个位
  77           - 隶属模块：内部
  78           - 参数说明：i:输入的一个4位十进制的数
  79           - 返回说明：
  80           - 注      ：
  81          *****************************************************************************************************/
  82          void itoa4(INT16U i)
  83          {
  84   1              bcd_number[0] = asc_number[(i % 10000) / 1000];
  85   1              bcd_number[1] = asc_number[(i % 1000) / 100];
  86   1              bcd_number[2] = asc_number[(i % 100) / 10];
  87   1              bcd_number[3] = asc_number[i % 10];
  88   1              bcd_number[4] = 0;
  89   1      }
  90          
  91          
  92          
  93          /*****************************************************************************************************
  94           - 函数说明：2MS任务的定时处理
  95           - 隶属模块：内部
  96           - 参数说明：无
  97           - 返回说明：
  98           - 注      ：需要增加任务处理的。往指定位置添加应用函数即可
  99          *****************************************************************************************************/
 100          void DS2MS_CNT(void)
 101          {
 102   1              static INT8U count = 0 ;
 103   1              if(1 == System_Flag_2Ms)
 104   1              {
 105   2                      System_Flag_2Ms = 0 ;
 106   2      /*************************************************
 107   2                   +--------------------+
 108   2                         2MS定时处理的任务
 109   2                       +--------------------+
 110   2      *************************************************/      
 111   2                  MSG_Task();//对消息的处理
 112   2                  
 113   2                      if((++count) == 5)
 114   2                      {
C51 COMPILER V9.01   MYLIB                                                                 07/20/2013 21:44:04 PAGE 3   

 115   3                              count = 0 ;
 116   3                              System_Flag_10Ms = 1 ;  
 117   3                      }
 118   2              }
 119   1      }
 120          
 121          /*****************************************************************************************************
 122           - 函数说明：10Ms任务处理
 123           - 隶属模块：内部
 124           - 参数说明：无
 125           - 返回说明：
 126           - 注      ：需要增加任务处理的。往指定位置添加应用函数即可
 127          *****************************************************************************************************/
 128          
 129          void DS10MS_CNT(void)
 130          {
 131   1              static INT8U counter = 0 ;
 132   1              if(1 == System_Flag_10Ms)
 133   1              {                                                                         
 134   2                      System_Flag_10Ms = 0 ;
 135   2      /*************************************************
 136   2                   +--------------------+
 137   2                         10MS定时处理的任务
 138   2                       +--------------------+
 139   2      *************************************************/
 140   2              key_scan();
 141   2              UartSend_Collide_Task();
 142   2              Uart_communication();
 143   2                      if((++counter) == 10)
 144   2                      {
 145   3                              counter = 0 ;
 146   3                              System_Flag_100Ms = 1 ;
 147   3                      }
 148   2              }
 149   1      }
 150          
 151          /*****************************************************************************************************
 152           - 函数说明：10Ms任务处理
 153           - 隶属模块：内部
 154           - 参数说明：无
 155           - 返回说明：
 156           - 注      ：需要增加任务处理的。往指定位置添加应用函数即可
 157          *****************************************************************************************************/
 158          
 159          void DS100MS_CNT(void)
 160          {
 161   1              static INT8U counter = 0 ;
 162   1              if(1 == System_Flag_100Ms)
 163   1              {                                                                         
 164   2                      System_Flag_100Ms = 0 ;
 165   2      /*************************************************
 166   2                   +--------------------+
 167   2                         100MS定时处理的任务
 168   2                       +--------------------+
 169   2                      1、100Ms的定时处理
 170   2      *************************************************/
 171   2                      FEED_WDT() ; //喂狗
 172   2                      Indicator_Scan();
 173   2              Time_Task() ;           
 174   2                      if(++counter == 5)
 175   2                      {
 176   3                              counter = 0 ;
C51 COMPILER V9.01   MYLIB                                                                 07/20/2013 21:44:04 PAGE 4   

 177   3                              System_Flag_500Ms = 1 ;
 178   3                      }
 179   2              }
 180   1      }
 181          
 182          
 183          /*****************************************************************************************************
 184           - 函数说明：500MS任务处理
 185           - 隶属模块：内部
 186           - 参数说明：无
 187           - 返回说明：
 188           - 注      ：需要增加任务处理的。往指定位置添加应用函数即可
 189          *****************************************************************************************************/
 190          
 191          void DS500MS_CNT(void)
 192          {
 193   1              if(1 == System_Flag_500Ms)
 194   1              {                                                                         
 195   2                      System_Flag_500Ms = 0 ;
 196   2                      
 197   2      /*************************************************
 198   2                   +--------------------+
 199   2                         半秒处理的任务
 200   2                       +--------------------+
 201   2      *************************************************/
 202   2              
 203   2              }
 204   1      }
 205          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    535    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21      16
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
