C51 COMPILER V9.01   SYSTEMINIT                                                            07/20/2013 21:44:04 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE SYSTEMINIT
OBJECT MODULE PLACED IN .\output\SystemInit.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE src\SystemInit.c BROWSE DEBUG OBJECTEXTEND PRINT(.\output\SystemInit.lst) O
                    -BJECT(.\output\SystemInit.obj)

line level    source

   1          #include "config.h"
   2          
   3          /*********************************************************************************************************
             -*********
   4                  
   5                                  +--------------------------------------------------+
   6                                                初始化+中断处理部分
   7                              +--------------------------------------------------+
   8          
   9           - 实现功能：
  10          
  11           - 目前进展：
  12          
  13           - 备注    ：
  14          **********************************************************************************************************
             -********/
  15          
  16          void RAM_Init(void) ;
  17          /*****************************************************************************************************
  18           - 功能描述：定时器0的初始化
  19           - 参数说明：无
  20           - 返回参数：无                                                                                           
  21           - 注：          
  22          *****************************************************************************************************/
  23          void Timer0_Init(void)
  24          {
  25   1              TMOD |= 0x01; 
  26   1              EA = 1 ;
  27   1              ET0= 1 ;
  28   1              TR0= 1 ;
  29   1              TH0= TIMER0_H;
  30   1              TL0= TIMER0_L;
  31   1      }
  32          
  33          /*****************************************************************************************************
  34           - 功能描述： 串口1初始化
  35           - 隶属模块： 外部
  36           - 参数说明： 无
  37           - 返回说明： 无
  38           - 注：       都是9600波特率
  39          *****************************************************************************************************/
  40          void Serial_init(void)
  41          {
  42   1              TMOD = 0x20;                // 设置 T1 为波特率发生器
  43   1              SCON = 0x50;                // 0101,0000 8位数据位, 无奇偶校验
  44   1                                                      
  45   1              PCON = 0x00;                //PCON=0;
  46   1      
  47   1              TH1=256-(SYS_Fosc/COMM_BAUD_RATE/32/12);//设置为9600波特率
  48   1              TL1=256-(SYS_Fosc/COMM_BAUD_RATE/32/12);
  49   1      
  50   1          TR1     = 1;                           //定时器1打开
  51   1          REN     = 1;                           //串口1接收使能
  52   1          ES      = 1;                           //串口1中断使能
C51 COMPILER V9.01   SYSTEMINIT                                                            07/20/2013 21:44:04 PAGE 2   

  53   1      }
  54          
  55          /*****************************************************************************************************
  56           - 功能描述：初始化
  57           - 参数说明：无
  58           - 返回参数：无
  59           - 注：无
  60          *****************************************************************************************************/
  61          void System_Init(void)
  62          {
  63   1              Serial_init() ;
  64   1              Timer0_Init() ;
  65   1              RAM_Init() ;
  66   1          itoa1(0);
  67   1          itoa2(0);
  68   1          itoa3(0);
  69   1          itoa4(0);
  70   1          TrigEnable = 1 ;
  71   1          PointFunc = POINTNUM_ONE ;
  72   1          input_vol = MAX_MAIN_VOL ;//上电默认最大音量
  73   1          System_Status = SYS_STATUS_WORK ;
  74   1          SysReturnTime = 30 ;//定义3S的时候等待模块初始化完成
  75   1      }
  76          
  77          /*****************************************************************************************************
  78           - 功能描述： 按键的初始化
  79           - 隶属模块： 外部
  80           - 参数说明： 无
  81           - 返回说明： 无
  82           - 注：
  83          *****************************************************************************************************/
  84          void RAM_Init(void)
  85          {
  86   1              System_Flag_2Ms    = 0 ;
  87   1              System_Flag_10Ms   = 0 ;
  88   1              System_Flag_100Ms  = 0 ;
  89   1              System_Flag_500Ms          = 0 ;
  90   1              RecvOver_Flag      = 0 ;
  91   1              Resend_Flag_Enable = 0 ;
  92   1              MainEnable  = TRUE ;  
  93   1          SysReturnTime = 0 ;
  94   1          PlayledCnt = 0 ;
  95   1          PlayledStatus = 0;
  96   1          PlayledStatus = SET_PLAYLED_OFF;
  97   1      }
  98          
  99          /*****************************************************************************************************
 100           - 功能描述：定时器0中断(任务调度)
 101           - 参数说明：无
 102           - 返回参数：无
 103           - 注：      该定时器起到系统调度的作用，产生一个2ms的时基。详见mylib.c文件
 104          *****************************************************************************************************/
 105          void Timer_0_interrupt(void) interrupt  1
 106          {
 107   1              TH0= TIMER0_H ;
 108   1              TL0= TIMER0_L ;
 109   1              System_Flag_2Ms = 1 ;
 110   1      }
 111          


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.01   SYSTEMINIT                                                            07/20/2013 21:44:04 PAGE 3   

   CODE SIZE        =    148    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
